---
title: "MÃ³dulo 2 â€” Tidyverse I"
subtitle: "mutate() y transmute()"
author: "CEPAL - Unidad de EstadÃ­sticas Sociales"
date: "`r Sys.Date()`"
format: 
  beamer: 
    # theme: "CambridgeUS"
    colortheme: dove
    fonttheme: professionalfonts
    # incremental: true
    aspectratio: 1610
    #theme: Berkeley
    toc: false
    slide-number: true
    mermaid: true  
    slide_level: 2
    #highlight: pygments
    #css: styles.css
Email: andres.gutierrez@cepal.org
lang: es
editor_options:
  markdown:
    wrap: 90
---


## 3. `mutate()` y `transmute()`


### ğŸ”¹ IntroducciÃ³n

Hasta ahora, hemos aprendido a **seleccionar** (`select`) y **filtrar** (`filter`) observaciones o columnas dentro de un conjunto de datos.  
El siguiente paso en la cadena de manipulaciÃ³n es **transformar** o **crear** variables nuevas.

AquÃ­ entran en juego dos funciones clave del paquete **dplyr**:

- `mutate()` â†’ modifica o agrega columnas sin eliminar las existentes.  
- `transmute()` â†’ genera nuevas columnas, descartando las anteriores.

Ambas son esenciales para construir indicadores, limpiar datos o preparar insumos para modelos estadÃ­sticos.


---

### ğŸ”¹ Objetivo

Permiten **crear o transformar columnas** dentro de un `data.frame` o `tibble`.

---

### âš™ï¸ `mutate()`

- Agrega **nuevas variables** o **modifica existentes**.  
- Mantiene todas las columnas originales.  
- Puede usar variables reciÃ©n creadas dentro del mismo `mutate()`.

```r
library(dplyr)

mtcars %>%
  mutate(
    consumo_km = mpg * 0.425,             # de millas/galÃ³n a km/litro
    potencia_relativa = hp / max(hp)      # proporciÃ³n de potencia
  )
```

ğŸ’¡ *Permite encadenar transformaciones sin perder las variables originales.*

---

### âš™ï¸ `transmute()`

* Similar a `mutate()`, pero **solo conserva las variables creadas**.
* Ãštil para construir indicadores o reducir la salida.

```r
mtcars %>%
  transmute(
    consumo_km = mpg * 0.425,
    potencia_relativa = hp / max(hp)
  )
```

ğŸ’¡ *Devuelve un tibble Ãºnicamente con las nuevas variables.*

---

### ğŸ§© Uso combinado con funciones auxiliares

* `if_else()` â†’ creaciÃ³n condicional
* `case_when()` â†’ mÃºltiples condiciones
* `across()` â†’ operaciones sobre grupos de columnas

Ejemplo:

```r
mtcars %>%
  mutate(
    tipo = if_else(cyl == 4, "Eficiente", "Potente"),
    potencia_log = log(hp)
  )
```

---

### ğŸ’¡ Ejemplo prÃ¡ctico

**Objetivo:** Crear un indicador estandarizado de eficiencia.

```r
mtcars %>%
  mutate(
    consumo_km = mpg * 0.425,
    eficiencia = consumo_km / mean(consumo_km)
  ) %>%
  select(model = rownames(mtcars), eficiencia)
```

Resultado: tibble con Ã­ndice de eficiencia relativo al promedio del conjunto.

---

### ğŸ§  ComparaciÃ³n resumida

| FunciÃ³n       | Conserva columnas originales | Crea nuevas variables | Ejemplo tÃ­pico               |
| ------------- | ---------------------------- | --------------------- | ---------------------------- |
| `mutate()`    | âœ… SÃ­                         | âœ… SÃ­                  | AÃ±adir una columna calculada |
| `transmute()` | âŒ No                         | âœ… SÃ­                  | Crear indicadores derivados  |

---

### ğŸ§­ Recomendaciones de uso

* Usa `mutate()` para **procesos exploratorios o pasos intermedios**.
* Usa `transmute()` para **resultados finales o salidas resumidas**.
* Combina con `across()` para aplicar transformaciones en bloque.

```r
mtcars %>%
  mutate(across(starts_with("d"), scale))
```

---

### ğŸ“š ConclusiÃ³n

Ambas funciones son **pilares en el flujo de trabajo del `tidyverse`**.
Facilitan la transformaciÃ³n progresiva y reproducible de datos,
alineando la sintaxis con la lÃ³gica de la manipulaciÃ³n funcional en R.

```
